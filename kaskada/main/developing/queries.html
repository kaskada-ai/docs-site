<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Queries :: Kaskada Docs</title>
    <link rel="canonical" href="https://kaskada-ai.github.io/docs-site/kaskada/main/developing/queries.html">
    <link rel="prev" href="tables.html">
    <link rel="next" href="example-queries.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
    <nav class="navbar">
        <div class="navbar-brand">
            <a class="navbar-item" href="https://kaskada-ai.github.io/docs-site">Kaskada Docs</a>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>
</header><div class="body">
<div class="nav-container" data-component="kaskada" data-version="main">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../getting-started/installation.html">Kaskada Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Getting Started</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/loading-data.html">Loading Data</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../getting-started/querying-data.html">Querying Data</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing.html">Installing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../loading-data.html">Loading Data</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="tables.html">Tables</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="queries.html">Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="example-queries.html">Example Queries</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="slices.html">Slices</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="views.html">Views</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="materializations.html">Working with Materializations</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Integrating</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrating/integrating-with-feature-stores.html">Integrating with ML feature stores</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tools and Resources</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tools-and-resources/training-realtime-ml-models.html">Training real-time ML models</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tools-and-resources/exporting-for-training.html">Example Modeling Problem</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fenl</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fenl/fenl-quick-start.html">Fenl Quick Start</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../fenl/language-guide.html">Fenl Language Guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fenl/data-model.html">Data model</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fenl/syntax.html">Syntax</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fenl/entities.html">Entities</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fenl/temporal-aggregation.html">Temporal Computation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fenl/aggregation-and-windowing.html">Aggregation and Windowing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../fenl/continuity.html">Continuity</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fenl/catalog.html">Fenl Catalog</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fenl/fenl-faq.html">Fenl FAQ</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fenl/working-with-records.html">Working with Records</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Kaskada Documentation</span>
    <span class="version">main</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../getting-started/installation.html">Kaskada Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../getting-started/installation.html">main</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../getting-started/installation.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../getting-started/installation.html">Kaskada Documentation</a></li>
    <li>Reference</li>
    <li><a href="queries.html">Queries</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Queries</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The following sections will help with writing queries.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="records"><a class="anchor" href="#records"></a><a class="link" href="#records">Records</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>All queries need to specify a record. A record is simply a set of named
expressions inside squiggly (curly) brackets, i.e., <code>{ }</code>.</p>
</div>
<div class="paragraph">
<p>An example record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-IPython hljs" data-lang="IPython">%%fenl
{
    time: Purchase.purchase_time,
    entity: Purchase.customer_id,
    max_amount: Purchase.amount | max(),
    min_amount: Purchase.amount | min(),
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This record has 4 fields, <code>time</code>, <code>entity</code>, <code>max_amount</code> and
<code>min_amount</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="querying-with-python"><a class="anchor" href="#querying-with-python"></a><a class="link" href="#querying-with-python">Querying with Python</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using python directly is one way to write queries.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import pandas
from kaskada import compute

query = """{
  time: Purchase.purchase_time,
  entity: Purchase.customer_id,
  max_amount: last(Purchase.amount) | max(),
  min_amount: Purchase.amount | min()
}"""

response_parquet = compute.query(query=query).parquet.path

pandas.read_parquet(response_parquet)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This returns a dataframe with the results of the query.</p>
</div>
<div class="sect2">
<h3 id="optional-parameters-with-python"><a class="anchor" href="#optional-parameters-with-python"></a><a class="link" href="#optional-parameters-with-python">Optional Parameters (with Python)</a></h3>
<div class="paragraph">
<p>When querying directly from python, the following optional parameters
are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>with_tables</strong>: A list of tables to use in the query, in addition to
the tables stored in the system.</p>
</li>
<li>
<p><strong>with_views</strong>: A list of views to use in the query, in addition to the
views stored in the system.</p>
</li>
<li>
<p><strong>result_behavior</strong>: Determines which results are returned. Either
<code>"all-results"</code> <em>(default)</em>, or <code>"final-results"</code> which returns only the
final values for each entity.</p>
</li>
<li>
<p><strong>response_as</strong>: Determines how the response is returned. Either
<code>"parquet"</code> <em>(default)</em> or <code>"redis-bulk"</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>"redis-bulk"</code>, result_behavior is assumed to be
<code>"final-results"</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>data_token_id</strong>: Enables repeatable queries. Queries performed against
the same data token always run on the same input data.</p>
</li>
<li>
<p><strong>limits</strong>: Configures limits on the output set.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="querying-with-fenlmagic"><a class="anchor" href="#querying-with-fenlmagic"></a><a class="link" href="#querying-with-fenlmagic">Querying with fenlmagic</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using the fenlmagic IPython extension makes iterating on queries easier.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The fenlmagic IPython extension is optional and isn&#8217;t required
to use Kaskada. Feel free to use whichever client interface fits your
workflow.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can make Fenl queries by prefixing a query block with <code>%%fenl</code>. The
query results will be computed and returned as a Pandas dataframe. The
query content starts on the next line and includes the rest of the code
block&#8217;s contents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-IPython hljs" data-lang="IPython">%%fenl
{
    time: Purchase.purchase_time,
    entity: Purchase.customer_id,
    max_amount: Purchase.amount | max(),
    min_amount: Purchase.amount | min(),
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This returns a dataframe with the results of the query.</p>
</div>
<div class="sect2">
<h3 id="optional-parameters-with-fenlmagic"><a class="anchor" href="#optional-parameters-with-fenlmagic"></a><a class="link" href="#optional-parameters-with-fenlmagic">Optional Parameters (with fenlmagic)</a></h3>
<div class="paragraph">
<p>When querying using fenlmagic, the following optional parameters are
available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>--result-behavior</strong>: Determines which results are returned. Either
<code>all-results</code> <em>(default)</em>, or <code>final-results</code> which returns only the
final values for each entity.</p>
</li>
<li>
<p><strong>--output</strong>: Output format for the query results. One of <code>df</code> dataframe
<em>(default)</em>, <code>json</code>, <code>parquet</code> or <code>redis-bulk</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If <code>redis-bulk</code>, --result-behavior is assumed to be <code>final-results</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>--data-token</strong>: Enables repeatable queries. Queries performed against
the same data token always run on the same input data.</p>
</li>
<li>
<p><strong>--preview-rows</strong>: Produces a preview of the data with at least this
many rows.</p>
</li>
<li>
<p><strong>--var</strong>: Assigns the body to a local variable with the given name.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example use of some of these options can be found in the next section:
<a href="#reference:example-queries">Example Queries</a></p>
</div>
</div>
<div class="sect2">
<h3 id="tables-and-views"><a class="anchor" href="#tables-and-views"></a><a class="link" href="#tables-and-views">Tables and Views</a></h3>
<div class="paragraph">
<p>Most basic queries operate against tables. However, queries can also
operate on views or a combination of tables and views.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of using a view to filter the values produced by an
expression using a table.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-IPython hljs" data-lang="IPython">%%fenl
{
  time: Purchase.purchase_time,
  entity: Purchase.customer_id,
  total_purchases: Purchase.amount | sum(),
} | when(PurchaseStats.max_amount &gt; 100)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Views may reference other views, so we could give this expression a name
and create a view for it as well if we wanted to.</p>
</div>
<div class="paragraph">
<p>Views are useful any time you need to share or re-use expressions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cleaning operations</p>
</li>
<li>
<p>Common business logic</p>
</li>
<li>
<p>Final feature vectors</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more help with tables and views, see <a href="#reference:tables">Working with Tables</a>
and <a href="#reference:views">Working with Views</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example-queries"><a class="anchor" href="#example-queries"></a><a class="link" href="#example-queries">Example Queries</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following examples will cover some of the common optional parameters
used when writing queries.</p>
</div>
<div class="sect2">
<h3 id="prerequisite-table-setup"><a class="anchor" href="#prerequisite-table-setup"></a><a class="link" href="#prerequisite-table-setup">Prerequisite: Table Setup</a></h3>
<div class="paragraph">
<p>First, we create two tables and load some data. The <em>purchases</em> table
contains a small amount of data loaded from 2 files. The <em>transactions</em>
table contains 50000 rows of data loaded from a single file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from kaskada import table as kt

def indent(text, amount, ch=' '):
        padding = amount * ch
        return ''.join(padding+line for line in str(text).splitlines(True))

t_purchases = kt.create_table(
    table_name =             "purchases",
    time_column_name =       "purchase_time",
    entity_key_column_name = "customer_id",
    subsort_column_name =    "subsort_id",
)
file_purchases1 = kt.upload_file(table="purchases", file_path="purchases_part1.parquet")
file_purchases2 = kt.upload_file(table=t_purchases, file_path="purchases_part2.parquet")
print(f"SUCCESS: Created Purchases table and uploaded data.")
print("\t Table Response:")
print(indent(t_purchases, 2, "\t"))
print("\t Upload Responses:")
print(indent(file_purchases1, 2, "\t"))
print(indent(file_purchases2, 2, "\t"))

t_transactions = kt.create_table(
    table_name =             "transactions",
    time_column_name =       "transaction_time",
    entity_key_column_name = "id",
    subsort_column_name =    "idx",
)
file_transactions1 = kt.upload_file(table=t_transactions, file_path="transactions_part1.parquet")
print(f"SUCCESS: Created Transactions table and uploaded data.")
print("\t Table Response:")
print(indent(t_transactions, 2, "\t"))
print("\t Upload Response:")
print(indent(file_transactions1, 2, "\t"))</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">SUCCESS: Created Purchases table and uploaded data.
     Table Response:
        table {
          table_id: "56437b49-4749-4d47-ad5e-ef680d34c750"
          table_name: "purchases"
          time_column_name: "purchase_time"
          entity_key_column_name: "customer_id"
          subsort_column_name: "subsort_id"
          create_time {
            seconds: 1638907853
            nanos: 587268229
          }
          update_time {
            seconds: 1638907853
            nanos: 587268229
          }
        }
        request_details {
          request_id: "985a39f0851a50b1c23551660f0925f1"
        }

     Upload Responses:
        data_token_id: "bdc9e595-a8a0-448c-9a95-c2e3d886b633"
        request_details {
          request_id: "dfcfa0026e4f0a99344329cfd80737ac"
        }

        data_token_id: "24c83cac-8cf4-4a45-98f0-dac8d5b303a2"
        request_details {
          request_id: "f36489c8eb48c8e01fd152bb95da4991"
        }

SUCCESS: Created Transactions table and uploaded data.
     Table Response:
        table {
          table_id: "24fd3343-1c3d-4ad7-bc67-8b367019afd3"
          table_name: "transactions"
          time_column_name: "transaction_date"
          entity_key_column_name: "msno"
          subsort_column_name: "idx"
          create_time {
            seconds: 1638907856
            nanos: 680641826
          }
          update_time {
            seconds: 1638907856
            nanos: 680641826
          }
        }
        request_details {
          request_id: "62a07d27133bedf8779dea9380e09a07"
        }

     Upload Response:
        data_token_id: "7bd4e740-9e63-418e-ba9b-5582db010959"
        request_details {
          request_id: "872984a9097bd6c8dd53d88845615f07"
        }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-data-token"><a class="anchor" href="#using-data-token"></a><a class="link" href="#using-data-token">Using <code>--data-token</code></a></h3>
<div class="paragraph">
<p><code>--data-token</code>: Enables repeatable queries. Queries performed against
the same data token always run on the same input data.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>use the data token id returned after loading the first file, and
results only include rows from the first file</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ipython hljs" data-lang="ipython">%%fenl --data-token bdc9e595-a8a0-448c-9a95-c2e3d886b633
purchases</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">data_token_id: "bdc9e595-a8a0-448c-9a95-c2e3d886b633"
request_details {
  request_id: "3f737ff336666515a54dd29a9c5ace3a"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top"></th>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">purchase_time</th>
<th class="tableblock halign-left valign-top">customer_id</th>
<th class="tableblock halign-left valign-top">vendor_id</th>
<th class="tableblock halign-right valign-top">amount</th>
<th class="tableblock halign-right valign-top">subsort_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-02 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-02 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-03 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-03 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-04 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-04 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-05 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-05 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>use the data token id returned after loading the second file, and
results rows from both files</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ipython hljs" data-lang="ipython">%%fenl --data-token 24c83cac-8cf4-4a45-98f0-dac8d5b303a2
purchases</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">data_token_id: "24c83cac-8cf4-4a45-98f0-dac8d5b303a2"
request_details {
  request_id: "3f737ff336666515a54dd29a9c5ace3a"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top"></th>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">purchase_time</th>
<th class="tableblock halign-left valign-top">customer_id</th>
<th class="tableblock halign-left valign-top">vendor_id</th>
<th class="tableblock halign-right valign-top">amount</th>
<th class="tableblock halign-right valign-top">subsort_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-02 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-02 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-03 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-03 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-04 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-04 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-05 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-05 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-06 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wh_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-06 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spongebob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">weenie_hut</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_007</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-07 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spongebob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">34</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wh_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-08 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">weenie_hut</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-08 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="using-result-behavior"><a class="anchor" href="#using-result-behavior"></a><a class="link" href="#using-result-behavior">Using <code>--result-behavior</code></a></h3>
<div class="paragraph">
<p><code>--result-behavior</code>: Determines which results are returned.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>use <code>all-results</code> (default) to return all the results for each entity:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ipython hljs" data-lang="ipython">%%fenl --result-behavior all-results
purchases</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">data_token_id: "7bd4e740-9e63-418e-ba9b-5582db010959"
request_details {
  request_id: "1badb8b0e220e26cc15b93b234ac3c14"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top"></th>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">purchase_time</th>
<th class="tableblock halign-left valign-top">customer_id</th>
<th class="tableblock halign-left valign-top">vendor_id</th>
<th class="tableblock halign-right valign-top">amount</th>
<th class="tableblock halign-right valign-top">subsort_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-01 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-02 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-02 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-03 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-03 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-04 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-04 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-05 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-05 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-06 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wh_001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-06 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spongebob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">weenie_hut</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_007</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-07 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spongebob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">34</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wh_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-08 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">weenie_hut</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-08 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>use <code>final-results</code> to return only the most recent event for
each entity</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ipython hljs" data-lang="ipython">%%fenl --result-behavior final-results
purchases</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">data_token_id: "7bd4e740-9e63-418e-ba9b-5582db010959"
request_details {
  request_id: "145bc51d9bac47f17fd202e5785e58b7"
}</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stripes-even stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-top"></th>
<th class="tableblock halign-left valign-top">id</th>
<th class="tableblock halign-left valign-top">purchase_time</th>
<th class="tableblock halign-left valign-top">customer_id</th>
<th class="tableblock halign-left valign-top">vendor_id</th>
<th class="tableblock halign-right valign-top">amount</th>
<th class="tableblock halign-right valign-top">subsort_id</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kk_006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-08 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">patrick</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krusty_krab</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wh_002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-08 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">karen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">weenie_hut</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cb_007</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-01-07 00:00:00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spongebob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">chum_bucket</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">34</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="using-preview-rows"><a class="anchor" href="#using-preview-rows"></a><a class="link" href="#using-preview-rows">Using <code>--preview-rows</code></a></h3>
<div class="paragraph">
<p><code>--preview-rows</code>: Produces a preview of the data with approximately this many rows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting a limit allows you to quickly iterate on features and verify
your results before running them over your full dataset</p>
</li>
<li>
<p>set to <code>50</code> on the <code>transactions</code> table to return a preview of at
least 50 rows</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ipython hljs" data-lang="ipython">%%fenl --preview-rows 50
transactions</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returns a dataframe of 71599 rows, instead of the full dataset of 100000
rows.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It may seem odd that many thousands of rows were returned when
only 50 were requested. This happens because query operates on batches
and will return the results of all batches processed in order to reach
the minimum set of rows requested. In this case, compute processed only
a single batch, but the batch had a size of 71599 rows. Note: Using
<code>--preview-rows</code> with <code>--result-behavior final-results</code> will cause the
full dataset to be processed, as all inputs must be processed to produce
final results.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="tables.html">Tables</a></span>
  <span class="next"><a href="example-queries.html">Example Queries</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
&copy; Copyright The Kaskada Authors 
</footer><script src="../../../_/js/site.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<script src="../../../_/js/vendor/fenl.min.js"></script>
<script>hljs.highlightAll();</script>
  </body>
</html>
